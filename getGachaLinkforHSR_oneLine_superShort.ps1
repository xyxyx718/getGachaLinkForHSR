Function f{param($_a,$_b);if($_b -gt 1){return $null};$_c=Join-Path $_a 'Star Rail\Games\StarRail_Data\webCaches';if(Test-Path $_c){$_d=Get-ChildItem -Path $_c -Directory;$_e=$_d|Sort-Object{$_.Name} -Descending|Select-Object -First 1;$_f=Join-Path $_e.FullName'Cache\Cache_Data\data_2';if(Test-Path $_f){return $_f};};$_g=Get-ChildItem -Path $_a -Directory -ErrorAction SilentlyContinue;foreach($_h in $_g){$_i=f -_a $_h.FullName -_b($_b+1);if($_i){return $_i}};return $null};Write-Host "`n本脚本来自：https://github.com/xyxyx718/getGachaLinkForHSR`n可以在微信小程序 咸鱼的崩铁助理 中使用提取到的链接分析跃迁记录`n查找跃迁记录中…";$_j=Get-PSDrive -PSProvider 'FileSystem';foreach($_k in $_j){$_l=$_k.Root;$_f=f -_a $_l -_b 0;if($_f){Write-Host "找到目标文件：$_f`n";$_m=Get-Content $_f -Raw;$_n='https://api-takumi\.mihoyo\.com/common/gacha_record/api/getGachaLog\?(?=.*authkey=)(?=.*region=)(?=.*gacha_id=)(?=.*gacha_type=).*?(?=\{)';$_o=[regex]::Matches($_m, $_n);if($_o.Count -gt 0){$_p=$_o[$_o.Count-1];Write-Host "最新的有效链接：`n$($_p.Value)`n`n你可以使用鼠标划动选中后，按下 Ctrl+C 来复制上面的链接。";$_q=Get-Item $_f;$_r=$_q.LastWriteTime.ToString("yyyy/MM/dd HH:mm:ss");Write-Host "data_2文件最后修改于 $_r ，跃迁记录链接有效期一天。";$_s=Get-Date;$_t=$_s-$_q.LastWriteTime;if($_t.TotalHours -gt 23){Write-Host "警告：该链接可能过期。如果过期，请进入游戏重新查看跃迁记录。"}}else{Write-Host "未找到有效链接"};Read-Host "按任意键关闭窗口...";exit}}Write-Host"未找到目标文件";Read-Host"按任意键关闭窗口...";exit